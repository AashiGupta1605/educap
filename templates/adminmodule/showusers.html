{% extends "./base.html" %}
{% block content %}

<script>
  function filldata(names) {
    document.getElementById("sid").value = names.pk
    document.getElementById("cou") = names.course

  }
//   document.getElementById('submit').onclick = function() {
//     var select = document.getElementById('cou');
//     var selected = [...select.selectedOptions]
//                     .map(option => option.value);
//     alert(selected);
//     console.log(selected)
//     document.getElementById("cour") = selected
// }
</script>


<!-- userCourse Modal -->
<div class="modal fade" id="userCourseModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Courses Permission</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
              <form action="../adminmodule/userCourseUpdate" method='GET' enctype="multipart/form-data">
                
                
                  <!-- {% csrf_token %} -->
                  <input type="text" name="sid" id="sid" hidden>
                  <div id="cou"></div>

                  {% for j in courses %}
                  <label for="vehicle1">{{j.name}}</label>
                  <input type="checkbox" name="{{j.name}}" value="{{j.pk}}"><br>
                  {% endfor %}
                  
                  
                  
                  <button class="btn btn-lg btn-primary btn-block" type="submit"
                      style="width: 100%;">Update</button>
              </form>
          </div>
         
          <!--  <div class="modal-footer"></div> -->
      </div>
  </div>
</div>




<div class="row shadow p-3 mb-3 bg-body rounded m-1 border">
  <h2>Users</h2>
</div>
<br>



{% if users %}
<table class="table table-striped project-orders-table shadow p-3 mb-5 bg-body border rounded">
  <thead>
    <tr>
      <th class="ml-5">Serial No.</th>
      <th>Name</th>
      <th>Email</th>
      <th>Status</th>
      <th>Action</th>
      <th>Courses</th>
    </tr>
  </thead>
  <tbody>
    {% for i,j in users %}
    <tr>
      <td>{{forloop.counter}}</td>
      <td><img style="border-radius: 30px;" alt="" width="30" height="24" class="d-inline-block align-text-top"
          src="../media/{{i.img}}">&nbsp;{{i.sname}}</td>
      <td>{{i.semail}}</td>
      <td>{{i.status}}</td>
      <td>
        <button type="button" class="btn btn-success btn-sm btn-icon-text mr-3">

              <a id="activate" href="../adminmodule/activateuser?data={{i.pk}}"
                style="text-decoration:None; color:white;">
                {% if i.status == "Inactive" %}
                Activate
                {% else %}
                Deactivate
                {% endif %}
              </a>
              <i class="typcn typcn-edit btn-icon-append"></i>

            </button>
          
      </td>
      <td>
        <!-- <button type="button" class="btn btn-success btn-sm btn-icon-text mr-3" onclick="filldata({'pk':'{{i.pk}}','name':'{{i.sname}}','course':'{{j}}'})">
        <a data-bs-toggle="modal" data-bs-target="#userCourseModal" style="text-decoration:None; color:white;">Courses</a>
      </button> -->
      <!-- <form action="../adminmodule/userCourseUpdate" method='GET' enctype="multipart/form-data">
        <input type="text" name="sid" id="sid" value="{{i.id}}" hidden>
        
        <select  multiple name="cou">

          {% for a in courses %}

          {% if a in j %}
          <option name="{{forloop.counter}}" value="{{a.id}}" selected>{{a.name}}</option>
          {% else %}
          <option name="{{forloop.counter}}" value="{{a.id}}">{{a.name}}</option>
          {% endif %}

          {% endfor %}
        </select>
        <button class="btn btn-lg btn-primary btn-block" type="submit" id="submit"
          style="width: 100%;">Save</button>
      </form> -->


      <form action="../adminmodule/userCourseUpdate" method='GET' enctype="multipart/form-data" id="courseForm">


        <input type="text" name="sid" id="sid" value="{{i.id}}" hidden>
        {% for a in courses %}

        <label for="vehicle1">{{a.name}}</label>
        {% if a in j %}
        <input type="checkbox" name="{{forloop.counter}}"  value="{{a.pk}}" checked><br>
        {% else %}
        <input type="checkbox" name="{{forloop.counter}}"  value="{{a.pk}}"><br>
        {% endif %}

        {% endfor %}
        <!-- onchange="document.getElementById('courseForm').submit();" -->
        <button class="btn btn-lg btn-primary btn-block" type="submit" style="width: 100%;">Save</button>
      </form>

      
      
      <!-- {% for k in j %}
      <button type="button" class="btn btn-success btn-sm btn-icon-text mr-3">
        {{k}}
      </button>
      {% endfor %} -->
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<nav aria-label="Page navigation example">
  <ul class="pagination" class="mx-auto">
    {% if users.has_previous %}
    <li class="page-item"><a class="page-link"
        href="{% url 'showusers' %}?page={{ users.previous_page_number }}">Previous</a></li>
    {% endif %}
    <li class="page-item"><a class="page-link" href="#">{{users.number}}</a></li>
    {% if users.has_next %}
    <li class="page-item"><a class="page-link" href="{% url 'showusers' %}?page={{ users.next_page_number }}">Next</a>
    </li>
    {% endif %}
  </ul>
</nav>

{% else %}
<h3 class="mx-auto" style="width: 400px;">
  There is no Donation yet
</h3>
{% endif %}

{% endblock %}